# [í†µí•© ê°€ì´ë“œ] ë‰´ìŠ¤ ì—ì´ì „íŠ¸ (NewsAgent)

ì´ ë¬¸ì„œëŠ” `backend/modules/news_agent.py` ëª¨ë“ˆì„ `aia_main.py`ì— í†µí•©í•˜ê¸° ìœ„í•œ ì§€ì¹¨ì…ë‹ˆë‹¤.
íŒ€ ì‘ì—… ê·œì¹™ì— ë”°ë¼ ë©”ì¸ íŒŒì¼ì„ ì§ì ‘ ìˆ˜ì •í•˜ì§€ ì•Šê³ , ì•„ë˜ ë‚´ìš©ì„ ë³µì‚¬í•˜ì—¬ ì ì ˆí•œ ìœ„ì¹˜ì— ë¶™ì—¬ë„£ì–´ ì£¼ì„¸ìš”.

---

### 0. í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (.env)
**ìœ„ì¹˜:** í”„ë¡œì íŠ¸ ë£¨íŠ¸ì˜ `.env` íŒŒì¼
**ì„¤ëª…:** ìœ„ì¹˜ ê¸°ë°˜ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ Azure Maps í‚¤ê°€ í•„ìš”í•©ë‹ˆë‹¤. ê¸°ì¡´ í”„ë¡œì íŠ¸ì˜ `.env` íŒŒì¼ì—ì„œ ë³µì‚¬í•˜ê±°ë‚˜ ìƒˆë¡œ ë°œê¸‰ë°›ì•„ ì¶”ê°€í•´ì£¼ì„¸ìš”.

```env
AZURE_MAPS_SUBSCRIPTION_KEY= (ì´ë¯¸ .envì— ì„¤ì •í•˜ì…¨ìŠµë‹ˆë‹¤)
```

---

### 1. Import êµ¬ë¬¸ ì¶”ê°€
**ìœ„ì¹˜:** `aira_main.py` íŒŒì¼ì˜ ìµœìƒë‹¨ import ì˜ì—­ (ì•½ 10ë²ˆì§¸ ì¤„ ë¶€ê·¼)

```python
# [NEW] ë‰´ìŠ¤ ì—ì´ì „íŠ¸ ëª¨ë“ˆ import
from modules.news_agent import NewsAgent, NewsConfig
```

---

### 2. ì´ˆê¸°í™” (Initialization)
**ìœ„ì¹˜:** `aira_main.py` ë‚´ë¶€, `gemini_worker()` í•¨ìˆ˜ ì‹œì‘ ë¶€ë¶„ (Client ì—°ê²° ì „)

```python
    # [NEW] NewsAgent ì´ˆê¸°í™”
    # í•„ìš”ì‹œ ì„¤ì •ì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    news_config = NewsConfig()
    news_config.URGENT_CHECK_INTERVAL = 30  # í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ 30ì´ˆë¡œ ë‹¨ì¶• ê°€ëŠ¥
    news_agent = NewsAgent(config=news_config)
    print("ğŸ“° NewsAgent Loaded.")
```

---

### 3. ê¸´ê¸‰ ì†ë³´ í™•ì¸ ë° ì¸í„°ëŸ½íŠ¸ (Main Loop Integration)
**ìœ„ì¹˜:** `gemini_worker()` ë‚´ë¶€, `send_loop()` í•¨ìˆ˜ ì•ˆì˜ `while True:` ë£¨í”„ ì‹œì‘ ë¶€ë¶„
**ì„¤ëª…:** ë£¨í”„ê°€ ëŒ ë•Œë§ˆë‹¤ ì£¼ê¸°ì ìœ¼ë¡œ ê¸´ê¸‰ ë‰´ìŠ¤ë¥¼ ì²´í¬í•˜ê³ , ì†ë³´ê°€ ìˆìœ¼ë©´ ì¦‰ì‹œ ì‹œìŠ¤í…œ ë©”ì‹œì§€ë¥¼ ì£¼ì…í•©ë‹ˆë‹¤.

```python
                    # [NEW] 1. ê¸´ê¸‰ ì†ë³´ ì²´í¬ (Non-blocking)
                    # 1ë¶„ë§ˆë‹¤ ì²´í¬ (NewsAgent ë‚´ë¶€ ë¡œì§)
                    urgent_msg = news_agent.fetch_and_sort_news()
                    if urgent_msg:
                        print(f"ğŸš¨ [INTERRUPT] {urgent_msg}")
                        # Geminiì—ê²Œ í…ìŠ¤íŠ¸ë¡œ ì†ë³´ ë‚´ìš©ì„ ì£¼ì…í•˜ì—¬ ì¦‰ì‹œ ë°œí™” ìœ ë„
                        await session.send(
                            input=f"[SYSTEM] ê¸´ê¸‰ ì†ë³´ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì¦‰ì‹œ ì‚¬ìš©ìì—ê²Œ ì•Œë¦¬ì„¸ìš”: {urgent_msg}",
                            end_of_turn=True
                        )
```

---

### 4. ì‹¬ì‹¬í’€ì´ ë‰´ìŠ¤ (Filler Integration)
**ìœ„ì¹˜:** `receive_loop()` ë‚´ë¶€ ë˜ëŠ” ë³„ë„ì˜ Silence Detector ë¡œì§
**ì„¤ëª…:** ëŒ€í™”ê°€ 3ì´ˆ ì´ìƒ ëŠê²¼ì„ ë•Œ(Silence), ì£¼ë¨¸ë‹ˆì—ì„œ ë‰´ìŠ¤ë¥¼ êº¼ë‚´ ëŒ€í™” ì£¼ì œë¡œ ë˜ì§‘ë‹ˆë‹¤.

```python
                        # [NEW] 2. ëŒ€í™” ê³µë°± ì‹œ ë‰´ìŠ¤ ì œì•ˆ (ì˜ˆì‹œ ë¡œì§)
                        # (ì‹¤ì œë¡œëŠ” VADë‚˜ Silence Timerê°€ í•„ìš”í•¨)
                        # if silence_duration > news_config.SILENCE_THRESHOLD:
                        #     story = news_agent.get_story_from_pocket()
                        #     if story:
                        #         filler_msg = f"ì°¸, ê·¸ê±´ ê·¸ë ‡ê³ .. {story} ë¼ëŠ” ì†Œì‹ì´ ìˆë„¤ìš”."
                        #         # Geminiì—ê²Œ ë°œí™” ìœ ë„
```

---

### [ì°¸ê³ ] ì˜ì¡´ì„± ë¼ì´ë¸ŒëŸ¬ë¦¬
ì•„ë˜ íŒ¨í‚¤ì§€ê°€ `requirements.txt`ì— í¬í•¨ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.
```
feedparser
requests
```
